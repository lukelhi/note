<mxfile host="app.diagrams.net" agent="Mozilla/5.0 (Windows NT 10.0; Win64; x64) AppleWebKit/537.36 (KHTML, like Gecko) Chrome/127.0.0.0 Safari/537.36" version="24.7.10" pages="6">
  <diagram id="_mmaKWedu-JH7YTA-TDT" name="服务划分">
    <mxGraphModel dx="1290" dy="635" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="rz005IzD-bQBJyHV0kme-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="rz005IzD-bQBJyHV0kme-4" target="rz005IzD-bQBJyHV0kme-5" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="260" y="150" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rz005IzD-bQBJyHV0kme-2" value="订阅topic" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rz005IzD-bQBJyHV0kme-1" vertex="1" connectable="0">
          <mxGeometry x="-0.1524" y="2" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rz005IzD-bQBJyHV0kme-3" value="RocketMQ" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="rz005IzD-bQBJyHV0kme-4" target="rz005IzD-bQBJyHV0kme-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rz005IzD-bQBJyHV0kme-4" value="通讯服务" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="390" y="125" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rz005IzD-bQBJyHV0kme-5" value="MQTT服务器&lt;div&gt;socket通信&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="190" y="125" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rz005IzD-bQBJyHV0kme-6" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="rz005IzD-bQBJyHV0kme-7" target="rz005IzD-bQBJyHV0kme-5" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="rz005IzD-bQBJyHV0kme-7" value="设备" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="50" y="125" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rz005IzD-bQBJyHV0kme-8" value="&lt;b&gt;账户服务&lt;/b&gt;&lt;div&gt;结单、算优惠券&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="590" y="240" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rz005IzD-bQBJyHV0kme-9" value="&lt;b&gt;channel通道服务&lt;/b&gt;&lt;div&gt;外部调用：微信、支付宝&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="590" y="360" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="yI0N3lpq5wtWdbjJ06jj-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="rz005IzD-bQBJyHV0kme-10" target="rz005IzD-bQBJyHV0kme-14" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="yI0N3lpq5wtWdbjJ06jj-2" value="通知开门" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="yI0N3lpq5wtWdbjJ06jj-1" vertex="1" connectable="0">
          <mxGeometry x="-0.0545" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rz005IzD-bQBJyHV0kme-10" value="&lt;b&gt;app服务&lt;/b&gt;&lt;div&gt;处理小程序功能&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="800" y="125" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rz005IzD-bQBJyHV0kme-11" value="&lt;b&gt;manage服务&lt;/b&gt;&lt;div&gt;后台管理页面&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="1010" y="125" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="rz005IzD-bQBJyHV0kme-12" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" parent="1" source="rz005IzD-bQBJyHV0kme-14" target="rz005IzD-bQBJyHV0kme-7" edge="1">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="640" y="70" />
              <mxPoint x="100" y="70" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="rz005IzD-bQBJyHV0kme-13" value="RocketMQ发送参数" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" parent="rz005IzD-bQBJyHV0kme-12" vertex="1" connectable="0">
          <mxGeometry x="-0.0449" relative="1" as="geometry">
            <mxPoint x="2" as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="rz005IzD-bQBJyHV0kme-14" value="&lt;b&gt;设备服务&lt;/b&gt;&lt;div&gt;集群部署，接受心跳，开关门&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="590" y="125" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="J6MmW372SjNbbnGJb2ZK-1" value="通讯服务有多台&lt;div&gt;通讯服务1对应设备：1 3 5..&lt;div&gt;通讯服务2&lt;span style=&quot;background-color: initial;&quot;&gt;对应设备&lt;/span&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;：2 4 6..&lt;/span&gt;&lt;/div&gt;&lt;/div&gt;&lt;div&gt;&lt;span style=&quot;background-color: initial;&quot;&gt;......&lt;/span&gt;&lt;/div&gt;&lt;div&gt;通过哈希规则记录设备连接在那台通讯服务&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="270" y="210" width="160" height="100" as="geometry" />
        </mxCell>
        <mxCell id="JGznQ-Zxpz_-ljCBLF32-1" value="微信可以同时下三笔单" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="570" y="438" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="JGznQ-Zxpz_-ljCBLF32-2" value="支付宝只能同时下一笔单" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="560" y="468" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="JIWTSPOe7DnRKa7prLQ3-1" value="两千多台设备" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="50" y="210" width="100" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="Tvsan3lRB1BJju_wXTPl" name="数据库设计">
    <mxGraphModel grid="1" page="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-2" value="设备类" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="180" y="115" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-3" value="商品类" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="180" y="390" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-4" value="订单类" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="180" y="1205" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-5" value="账户类" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="180" y="535" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-6" value="系统" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="180" y="1460" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-7" value="优惠券" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="180" y="735" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-8" value="活动" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="180" y="960" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-61" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="HB1MnKsnWOgQsZj4sdtt-11" target="HB1MnKsnWOgQsZj4sdtt-60" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-11" value="设备表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="25" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-66" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="HB1MnKsnWOgQsZj4sdtt-17" target="HB1MnKsnWOgQsZj4sdtt-62" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-17" value="仓门表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="90" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-71" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="HB1MnKsnWOgQsZj4sdtt-20" target="HB1MnKsnWOgQsZj4sdtt-63" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-20" value="货道表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="145" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-80" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="HB1MnKsnWOgQsZj4sdtt-21" target="HB1MnKsnWOgQsZj4sdtt-79" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-21" value="设备重量记录表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="260" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-25" value="购买" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="1000" y="660" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-26" value="补货" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="1000" y="735" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-27" value="校准" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="1000" y="815" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-28" value="灯、加热" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="1000" y="895" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-29" value="设备上下线" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="1000" y="975" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-39" value="商品详情表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="430" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-40" value="商品类型表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="380" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-77" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="HB1MnKsnWOgQsZj4sdtt-41" target="HB1MnKsnWOgQsZj4sdtt-75" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-41" value="设备心跳表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="205" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-87" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;exitX=1;exitY=0.5;exitDx=0;exitDy=0;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="HB1MnKsnWOgQsZj4sdtt-42" target="HB1MnKsnWOgQsZj4sdtt-81" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-42" value="补货订单表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="1100" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-88" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="HB1MnKsnWOgQsZj4sdtt-43" target="HB1MnKsnWOgQsZj4sdtt-82" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-43" value="补货订单详情表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="1164.5" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-89" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="HB1MnKsnWOgQsZj4sdtt-44" target="HB1MnKsnWOgQsZj4sdtt-84" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-44" value="校准订单表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="1230" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-45" value="订单详情表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="1400" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-90" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0;entryY=0.5;entryDx=0;entryDy=0;" parent="1" source="HB1MnKsnWOgQsZj4sdtt-46" target="HB1MnKsnWOgQsZj4sdtt-86" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-46" value="购买订单表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="1290" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-47" value="通道订单表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="1350" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-48" value="优惠券配置表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="675" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-49" value="优惠发放用户表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="720" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-50" value="优惠发放详情表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="765" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-51" value="优惠使用详情表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="815" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-54" value="账户表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="530" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-55" value="账户详情表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="570" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-56" value="活动表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="930" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-57" value="充值活动表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="975" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-58" value="充值订单表" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="364" y="1020" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-60" value="设备uid、sn、设备状态012、设备类型、加热开关、&lt;div&gt;地址信息、经纬度&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="545" y="10" width="160" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-63" value="货道uid、设备uid、仓门uid、&lt;div&gt;货道重量、货道商品最大数量、补货触发阈值、商品uid、商品现有库存数量、货道状态&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="550" y="135" width="260" height="50" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-62" value="仓门uid、设备uid、仓门状态012、" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="550" y="85" width="120" height="40" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-75" value="设备uid、设备温度、&lt;div&gt;信号强度、心跳时间&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="550" y="200" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-79" value="货道uid、货道重量、&lt;div&gt;重量是否稳定01&lt;/div&gt;" style="whiteSpace=wrap;html=1;rounded=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="550" y="255" width="140" height="40" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-81" value="补货单uid、补货单号、&lt;div&gt;补货员uid、设备uid、&lt;/div&gt;&lt;div&gt;仓门uid、补货状态012&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="530" y="1090" width="140" height="50" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-82" value="补货详情uid、补货单uid、补货单号、货道uid、补货数量、补货完成库存数量，补货状态、数据来源01" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="530" y="1152" width="190" height="55" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-83" value="补货产生的订单" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="675" y="1098" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-84" value="校准单uid、校准单号、&lt;div&gt;操作员uid、设备uid、货道uid&lt;div&gt;仓门uid、订单状态012&lt;/div&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="530" y="1220" width="160" height="50" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-85" value="校准货道的订单" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="717" y="1230" width="110" height="30" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-86" value="用户uid、设备uid、仓门uid、订单金额、实付金额、下单时间、开门时间、支付时间、小程序类型01、&lt;span style=&quot;background-color: initial;&quot;&gt;订单状态0123456、支付状态0123、操作状态0123（是否开门）&lt;/span&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="530" y="1280" width="310" height="50" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-92" value="业务类型" style="rounded=1;whiteSpace=wrap;html=1;" parent="1" vertex="1">
          <mxGeometry x="780" y="810" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="HB1MnKsnWOgQsZj4sdtt-94" value="一个设备对应两个仓门" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="700" y="90" width="140" height="30" as="geometry" />
        </mxCell>
        <mxCell id="MKWD--2Ake05pg9fZmaW-4" value="" style="swimlane;startSize=0;" parent="1" vertex="1">
          <mxGeometry x="350" y="10" width="150" height="290" as="geometry" />
        </mxCell>
        <mxCell id="MKWD--2Ake05pg9fZmaW-5" value="" style="swimlane;startSize=0;" parent="1" vertex="1">
          <mxGeometry x="350" y="360" width="150" height="120" as="geometry" />
        </mxCell>
        <mxCell id="MKWD--2Ake05pg9fZmaW-6" value="" style="swimlane;startSize=0;" parent="1" vertex="1">
          <mxGeometry x="350" y="1080" width="150" height="370" as="geometry" />
        </mxCell>
        <mxCell id="MKWD--2Ake05pg9fZmaW-7" value="" style="swimlane;startSize=0;" parent="1" vertex="1">
          <mxGeometry x="350" y="505" width="150" height="115" as="geometry" />
        </mxCell>
        <mxCell id="MKWD--2Ake05pg9fZmaW-8" value="" style="swimlane;startSize=0;" parent="1" vertex="1">
          <mxGeometry x="350" y="920" width="150" height="140" as="geometry" />
        </mxCell>
        <mxCell id="MKWD--2Ake05pg9fZmaW-10" value="" style="swimlane;startSize=0;" parent="1" vertex="1">
          <mxGeometry x="350" y="660" width="150" height="200" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="C5RBs43oDa-KdzZeNtuy" name="小程序app下单流程">
    <mxGraphModel dx="1290" dy="541" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="WIyWlLk6GJQsqaUBKTNV-1" parent="WIyWlLk6GJQsqaUBKTNV-0" />
        <mxCell id="12C6LShC_6Dfq5QouzWi-2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="12C6LShC_6Dfq5QouzWi-0" target="12C6LShC_6Dfq5QouzWi-1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="12C6LShC_6Dfq5QouzWi-0" value="用户APP下单流程" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="250" y="110" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="12C6LShC_6Dfq5QouzWi-4" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="12C6LShC_6Dfq5QouzWi-1" target="12C6LShC_6Dfq5QouzWi-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="12C6LShC_6Dfq5QouzWi-1" value="用户扫码开门" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="240" y="250" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="12C6LShC_6Dfq5QouzWi-8" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="12C6LShC_6Dfq5QouzWi-3" target="12C6LShC_6Dfq5QouzWi-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="12C6LShC_6Dfq5QouzWi-3" target="sHwbM8AoxcGB93GjoSef-0">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="12C6LShC_6Dfq5QouzWi-3" value="&lt;b&gt;用户参数校验&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="237.5" y="390" width="125" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-4" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="12C6LShC_6Dfq5QouzWi-7" target="sHwbM8AoxcGB93GjoSef-3">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-6" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="12C6LShC_6Dfq5QouzWi-7" target="sHwbM8AoxcGB93GjoSef-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="12C6LShC_6Dfq5QouzWi-7" value="加分布式锁" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="240" y="510" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-0" value="检查用户是否有未支付订单&lt;div&gt;校验设备是否正常&lt;/div&gt;&lt;div&gt;舱门是否正常&lt;/div&gt;&lt;div&gt;校验货道是否匹配商品&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="10" y="375" width="147.5" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-3" value="同一时间：一个门只能一个用户购买&lt;div&gt;补货开门、改价格也是这把锁&lt;/div&gt;&lt;div&gt;&lt;br&gt;&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="10" y="495" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-8" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="sHwbM8AoxcGB93GjoSef-5" target="sHwbM8AoxcGB93GjoSef-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-5" value="&lt;b&gt;生成订单号&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="240" y="630" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-10" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="sHwbM8AoxcGB93GjoSef-7" target="sHwbM8AoxcGB93GjoSef-9">
          <mxGeometry relative="1" as="geometry">
            <Array as="points">
              <mxPoint x="430" y="785" />
              <mxPoint x="430" y="275" />
            </Array>
          </mxGeometry>
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-7" value="&lt;b&gt;保存订单&lt;/b&gt;&lt;div&gt;订单状态为未授权&lt;/div&gt;&lt;div&gt;仓门状态为为开门&lt;/div&gt;&lt;div&gt;支付状态为未支付&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="240" y="750" width="120" height="70" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-12" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="sHwbM8AoxcGB93GjoSef-9" target="sHwbM8AoxcGB93GjoSef-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="sHwbM8AoxcGB93GjoSef-9" target="sHwbM8AoxcGB93GjoSef-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-9" value="微信、支付宝端创建预授权订单" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="480" y="250" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="sHwbM8AoxcGB93GjoSef-11" target="sHwbM8AoxcGB93GjoSef-13">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-21" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="sHwbM8AoxcGB93GjoSef-11" target="sHwbM8AoxcGB93GjoSef-20">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-11" value="更改订单状态为授权中" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="480" y="380" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-13" value="微信界面未知&lt;div&gt;定时任务超过1min未授权取消订单，释放分布式锁&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="680" y="370" width="120" height="70" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-15" value="订单号告诉微信支付宝做预授权、免密支付，创建成功再开门" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="680" y="250" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-17" value="支付宝、微信支付分签约预授权，可以后面用来支付" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="390" y="200" width="300" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-19" value="定时任务，或用延时消息" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="660" y="340" width="160" height="30" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-23" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="sHwbM8AoxcGB93GjoSef-20" target="sHwbM8AoxcGB93GjoSef-22">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-25" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="sHwbM8AoxcGB93GjoSef-20" target="sHwbM8AoxcGB93GjoSef-24">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-20" value="返回前端拉起信用授权，输入密码认证" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="480" y="510" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-27" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="sHwbM8AoxcGB93GjoSef-22" target="sHwbM8AoxcGB93GjoSef-26">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-22" value="回调授权成功，更改订单状态为&lt;b&gt;授权成功&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="680" y="510" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-24" value="用户操作完成" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="490" y="630" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-29" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="sHwbM8AoxcGB93GjoSef-26" target="sHwbM8AoxcGB93GjoSef-28">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="v3sdVp-0Pb3BsuNVeRYt-0" value="保险" style="edgeLabel;html=1;align=center;verticalAlign=middle;resizable=0;points=[];" vertex="1" connectable="0" parent="sHwbM8AoxcGB93GjoSef-29">
          <mxGeometry x="-0.15" y="-1" relative="1" as="geometry">
            <mxPoint as="offset" />
          </mxGeometry>
        </mxCell>
        <mxCell id="LviFiSIzcgDLLVsNyvzU-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="WIyWlLk6GJQsqaUBKTNV-1" source="sHwbM8AoxcGB93GjoSef-26" target="LviFiSIzcgDLLVsNyvzU-0">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-26" value="发送消息通知&lt;b&gt;货柜设备服务，开启仓门&lt;/b&gt;" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="680" y="640" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="sHwbM8AoxcGB93GjoSef-28" value="定时任务：舱门一直没开，取消订单，订单状态设置为异常" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="880" y="640" width="120" height="50" as="geometry" />
        </mxCell>
        <mxCell id="LviFiSIzcgDLLVsNyvzU-0" value="购买订单表" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.database;whiteSpace=wrap;" vertex="1" parent="WIyWlLk6GJQsqaUBKTNV-1">
          <mxGeometry x="705" y="730" width="70" height="80" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="lP9W9_bwQSpXR4bxz724" name="设备服务">
    <mxGraphModel dx="1290" dy="635" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="WKDUl6PxpLN5j0pVtLqM-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="WKDUl6PxpLN5j0pVtLqM-1" target="WKDUl6PxpLN5j0pVtLqM-2" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="WKDUl6PxpLN5j0pVtLqM-1" value="收到下单请求" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" parent="1" vertex="1">
          <mxGeometry x="210" y="150" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="WKDUl6PxpLN5j0pVtLqM-5" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="WKDUl6PxpLN5j0pVtLqM-2" target="WKDUl6PxpLN5j0pVtLqM-4" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="WKDUl6PxpLN5j0pVtLqM-7" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="WKDUl6PxpLN5j0pVtLqM-2" target="WKDUl6PxpLN5j0pVtLqM-6" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="WKDUl6PxpLN5j0pVtLqM-2" value="建立仓门订单缓存" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="200" y="280" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="WKDUl6PxpLN5j0pVtLqM-4" value="缓存：订单号，&lt;b&gt;当前舱门各货道重量&lt;/b&gt;，设备id、仓门id、userid" style="whiteSpace=wrap;html=1;rounded=1;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="400" y="280" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="JsDU8NLvN8efZuY7gjRE-2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" parent="1" source="WKDUl6PxpLN5j0pVtLqM-6" target="JsDU8NLvN8efZuY7gjRE-1" edge="1">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="WKDUl6PxpLN5j0pVtLqM-6" value="检查设备连接在哪台通讯服务上" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="200" y="420" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="JsDU8NLvN8efZuY7gjRE-1" value="根据&lt;b&gt;设备类型&lt;/b&gt;选择不同的&lt;b&gt;执行器&lt;/b&gt;发送字节码或MQTT消息" style="rounded=1;whiteSpace=wrap;html=1;strokeWidth=2;" parent="1" vertex="1">
          <mxGeometry x="200" y="560" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="JsDU8NLvN8efZuY7gjRE-3" value="不同设备的通信协议不一样" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" parent="1" vertex="1">
          <mxGeometry x="350" y="570" width="170" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="TQeRZn2sawfEglswqtB8" name="manage服务">
    <mxGraphModel dx="1290" dy="635" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="fOmpOUSKuiHL8BsP1QxZ-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="fOmpOUSKuiHL8BsP1QxZ-2" target="fOmpOUSKuiHL8BsP1QxZ-4">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fOmpOUSKuiHL8BsP1QxZ-2" value="初始化设备" style="whiteSpace=wrap;html=1;rounded=1;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="230" y="170" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fOmpOUSKuiHL8BsP1QxZ-3" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="fOmpOUSKuiHL8BsP1QxZ-4" target="fOmpOUSKuiHL8BsP1QxZ-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fOmpOUSKuiHL8BsP1QxZ-4" value="配置仓门、货道、商品" style="whiteSpace=wrap;html=1;rounded=1;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="230" y="290" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fOmpOUSKuiHL8BsP1QxZ-5" value="通知货柜修改价签" style="whiteSpace=wrap;html=1;rounded=1;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="230" y="410" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fOmpOUSKuiHL8BsP1QxZ-12" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="fOmpOUSKuiHL8BsP1QxZ-6" target="fOmpOUSKuiHL8BsP1QxZ-8">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fOmpOUSKuiHL8BsP1QxZ-13" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="fOmpOUSKuiHL8BsP1QxZ-6" target="fOmpOUSKuiHL8BsP1QxZ-10">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fOmpOUSKuiHL8BsP1QxZ-14" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;entryX=0.5;entryY=0;entryDx=0;entryDy=0;" edge="1" parent="1" source="fOmpOUSKuiHL8BsP1QxZ-6" target="fOmpOUSKuiHL8BsP1QxZ-2">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="fOmpOUSKuiHL8BsP1QxZ-6" value="管理服务" style="strokeWidth=2;html=1;shape=mxgraph.flowchart.terminator;whiteSpace=wrap;" vertex="1" parent="1">
          <mxGeometry x="434" y="10" width="100" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fOmpOUSKuiHL8BsP1QxZ-8" value="去皮、校准" style="whiteSpace=wrap;html=1;rounded=1;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="424" y="170" width="120" height="60" as="geometry" />
        </mxCell>
        <mxCell id="fOmpOUSKuiHL8BsP1QxZ-10" value="补货" style="whiteSpace=wrap;html=1;rounded=1;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="614" y="170" width="120" height="60" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
  <diagram id="baXr2pmCO4-EDMSP9ltN" name="通信服务">
    <mxGraphModel dx="463" dy="541" grid="1" gridSize="10" guides="1" tooltips="1" connect="1" arrows="1" fold="1" page="1" pageScale="1" pageWidth="827" pageHeight="1169" math="0" shadow="0">
      <root>
        <mxCell id="0" />
        <mxCell id="1" parent="0" />
        <mxCell id="gGv-CXXih761iv7lcRqF-1" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="gGv-CXXih761iv7lcRqF-3" target="gGv-CXXih761iv7lcRqF-5">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-2" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="gGv-CXXih761iv7lcRqF-3" target="gGv-CXXih761iv7lcRqF-15">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-3" value="长连接" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1300" y="50" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-4" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="gGv-CXXih761iv7lcRqF-5" target="gGv-CXXih761iv7lcRqF-7">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-5" value="Socket(Netty)" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1120" y="160" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-6" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="gGv-CXXih761iv7lcRqF-7" target="gGv-CXXih761iv7lcRqF-9">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-7" value="登录" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1120" y="275" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-8" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="gGv-CXXih761iv7lcRqF-9" target="gGv-CXXih761iv7lcRqF-11">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-9" value="设备表初始化" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1120" y="370" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-10" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="gGv-CXXih761iv7lcRqF-11" target="gGv-CXXih761iv7lcRqF-23">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-11" value="设备信息存缓存&lt;div&gt;（基本不怎么变）&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1120" y="480" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-12" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="gGv-CXXih761iv7lcRqF-15" target="gGv-CXXih761iv7lcRqF-17">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-13" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="gGv-CXXih761iv7lcRqF-15" target="gGv-CXXih761iv7lcRqF-25">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-14" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="gGv-CXXih761iv7lcRqF-15" target="gGv-CXXih761iv7lcRqF-25">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-15" value="发送心跳" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1300" y="160" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-16" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="gGv-CXXih761iv7lcRqF-17" target="gGv-CXXih761iv7lcRqF-20">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-17" value="redis保存心跳" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1300" y="275" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-18" value="&lt;div&gt;redis哈希结构&lt;/div&gt;heart&amp;nbsp; sn1 30s&lt;div&gt;&amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; &amp;nbsp; sn2 30s&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1430" y="275" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-19" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="gGv-CXXih761iv7lcRqF-20" target="gGv-CXXih761iv7lcRqF-21">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-20" value="过期回调" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1300" y="370" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-21" value="设备下线" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1300" y="480" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-22" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="gGv-CXXih761iv7lcRqF-23" target="gGv-CXXih761iv7lcRqF-26">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-23" value="sn、设备状态、最后一次心跳时间..." style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="940" y="480" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-24" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="gGv-CXXih761iv7lcRqF-25" target="gGv-CXXih761iv7lcRqF-28">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-25" value="定时1min轮询心跳&lt;div&gt;遍历最后一次心跳时间&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1480" y="160" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-26" value="收到心跳就更新最后一次时间" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="940" y="570" width="100" height="50" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-27" value="" style="edgeStyle=orthogonalEdgeStyle;rounded=0;orthogonalLoop=1;jettySize=auto;html=1;" edge="1" parent="1" source="gGv-CXXih761iv7lcRqF-28" target="gGv-CXXih761iv7lcRqF-29">
          <mxGeometry relative="1" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-28" value="&lt;b&gt;心跳计数器&lt;/b&gt;&lt;div&gt;2000台设备，1min&lt;span style=&quot;background-color: initial;&quot;&gt;4000心跳&lt;/span&gt;&lt;/div&gt;&lt;div&gt;80%的阈值，3200次心跳&lt;/div&gt;&lt;div&gt;正常&lt;/div&gt;" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1660" y="145" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-29" value="如果要下线，检查心跳计数器小于3200，先不给下线，说明服务出问题，先不给下线" style="rounded=1;whiteSpace=wrap;html=1;absoluteArcSize=1;arcSize=14;strokeWidth=2;" vertex="1" parent="1">
          <mxGeometry x="1660" y="255" width="160" height="80" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-30" value="自我保护机制" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="1684" y="105" width="100" height="30" as="geometry" />
        </mxCell>
        <mxCell id="gGv-CXXih761iv7lcRqF-31" value="如：第一次心跳5S，第二次35S就到了" style="text;html=1;align=center;verticalAlign=middle;resizable=0;points=[];autosize=1;strokeColor=none;fillColor=none;" vertex="1" parent="1">
          <mxGeometry x="1625" y="360" width="230" height="30" as="geometry" />
        </mxCell>
      </root>
    </mxGraphModel>
  </diagram>
</mxfile>
